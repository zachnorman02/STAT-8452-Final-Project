---
title: "Final Project"
format: pdf
editor: visual
---

```{r setup, include=F}
library(tidyverse)
```


```{r, message=FALSE}
data = read_csv("Sleep_Analysis.csv")
dim(data)
names(data)
head(data)
```
```{r}
colnames(data) = make.names(colnames(data)) %>% unique()
data %>%
  mutate(
    physical.illness = if_else(physical.illness=='no',0,1),
    bluelight.filter = ifelse(bluelight.filter=='no',0,1),
    smoke.drink = ifelse(smoke.drink=='no',0,1),
    meals.day = case_when(
      meals.day=='one'~1,
      meals.day=='two'~2,
      meals.day=='three'~3,
      meals.day=='four'~4,
      meals.day=='five'~5,
      meals.day=='more than 5'~6,
      .default=0
    )
  )
data
```

# Mean Sleep Duration

```{r}
sleep_time = data %>% 
  filter(round(sleep.time,4) != 6.7575) %>% 
  select(sleep.time)

sleep_time %>% 
  ggplot() +
    geom_density(aes(x=sleep.time))
```


```{r}
mean(data$sleep.time)
t.test(sleep_time, mu=7)
```

# Compare male/female
```{r}
data_by_gender = data %>% 
  select(Gender, sleep.time) %>%
  filter(Gender %in% c("Male", "Female"), round(sleep.time,4) != 6.7575)

t.test(sleep.time ~ Gender, data=data_by_gender)
```

```{r}
wilcox.test(sleep.time ~ Gender, data=data_by_gender)
```

